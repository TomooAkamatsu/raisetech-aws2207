---
- name: Install Ruby dependences packages
  yum:
    name:
      - gcc-c++
      - make
      - patch
      - curl
      - zlib-devel
      - openssl-devel
      - ImageMagick-devel
      - readline-devel
      - libcurl-devel
      - libffi-devel
      - libicu-devel
      - libxml2-devel
      - libxslt-devel
      - mysql-devel
    state: latest

- name: Registration yarn on Yum repo
  shell: curl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo

- name: Install yarn
  yum:
    name: yarn
    state: latest

- name: Git clone rbenv
  git:
    repo: https://github.com/rbenv/rbenv.git
    dest: /usr/local/rbenv

- name: Install rbenv
  shell:
    cmd: |
      echo 'export PATH="/usr/local/rbenv/bin:$PATH"' >> ~/.bash_profile
      echo 'eval "$(rbenv init -)"' >> ~/.bash_profile
      source ~/.bash_profile

- name: Git clone ruby_build
  git:
    repo: https://github.com/sstephenson/ruby-build.git
    dest: ~/.rbenv/plugins/ruby-build

- name: Install Ruby
  shell: rbenv install 2.6.3
